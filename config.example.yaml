# The Red Phone Configuration
# Copy to /etc/redphone/config.yaml and customize

phone:
  # Display name shown to other phones
  name: "Kitchen"
  
  # Unique SIP extension number (101-999)
  extension: 101

# ==============================================================================
# NETWORK / VPN CONFIGURATION
# ==============================================================================
# Choose ONE VPN provider and configure it below.
# Options: openvpn, tailscale, none

network:
  # VPN provider to use: openvpn | tailscale | none
  vpn: tailscale
  
  # --------------------------------------------------------------------------
  # OPTION 1: Tailscale (recommended for simplicity)
  # --------------------------------------------------------------------------
  # Zero-config mesh VPN. Install: curl -fsSL https://tailscale.com/install.sh | sh
  # Then run: sudo tailscale up
  # Tag your phones in Tailscale admin console for discovery.
  
  tailscale:
    # Your Tailscale network name (shown in admin console)
    tailnet: example.ts.net
    
    # Tag for phone discovery (add "tag:redphone" to phones in Tailscale admin)
    tag: redphone
  
  # --------------------------------------------------------------------------
  # OPTION 2: OpenVPN (for Asuswrt-Merlin routers or self-hosted)
  # --------------------------------------------------------------------------
  # Requires .ovpn file from your router/server.
  # See docs/OPENVPN.md for Asuswrt-Merlin setup.
  # IMPORTANT: Enable "Allow Client â†” Client" on router for discovery!
  
  openvpn:
    # Path to .ovpn config file (export from router)
    config_file: /etc/redphone/vpn/client.ovpn
    
    # Credentials file (line 1: username, line 2: password)
    auth_file: /etc/redphone/vpn/auth.txt
    
    # Auto-reconnect on disconnect
    auto_reconnect: true
    
    # Seconds to wait before reconnecting
    reconnect_delay: 10

# ==============================================================================
# AUDIO
# ==============================================================================

audio:
  # ALSA device names (use 'arecord -l' and 'aplay -l' to list)
  input: "default"
  output: "default"
  
  # Volume levels (0-100)
  ring_volume: 80
  call_volume: 70
  
  # Ring tone file (relative to /opt/redphone/ui/sounds/)
  ringtone: "classic.wav"

# ==============================================================================
# QUIET HOURS
# ==============================================================================
# Require confirmation for calls during these hours.

quiet_hours:
  enabled: true
  start: "22:00"
  end: "08:00"
  timezone: "Asia/Tokyo"

# ==============================================================================
# DISCOVERY
# ==============================================================================
# How phones find each other on the network.

discovery:
  # mDNS for local network (always recommended)
  mdns: true
  
  # Tailscale API discovery (when vpn: tailscale)
  # Queries Tailscale for machines with the configured tag
  tailscale_api: true
  
  # UDP broadcast discovery (when vpn: openvpn or for LAN)
  # Broadcasts presence on VPN/LAN subnet
  udp_broadcast: true
  udp_port: 5199
  
  # How often to announce/poll (seconds)
  announce_interval: 30
  
  # Mark phone offline after this many seconds without announcement
  phone_timeout: 120

# ==============================================================================
# UI
# ==============================================================================

ui:
  theme: dark
  screen_timeout: 300
  show_clock: true

# ==============================================================================
# ADMIN
# ==============================================================================
# Enable for remote configuration via REST API.

admin:
  enabled: false
  password: ""
  serve_config: false

# Pull config from central admin server (optional)
config:
  server: ""
  pull_interval: 300

# ==============================================================================
# GPIO (Raspberry Pi)
# ==============================================================================
# Hook switch detection via GPIO pin.

gpio:
  enabled: false
  hook_pin: 17
  hook_logic: high_on_lift  # or low_on_lift

# ==============================================================================
# DEBUG MODE
# ==============================================================================
# Enable debug panel in web UI to simulate hardware actions.

debug:
  # Show debug panel in web UI
  enabled: false
  
  # Allow simulating hardware events (handset, GPIO, etc.)
  simulate_hardware: true
  
  # Show state info overlay
  show_state: true

# ==============================================================================
# LOGGING
# ==============================================================================

logging:
  level: INFO
  file: /var/log/redphone/app.log

# ==============================================================================
# ASTERISK PBX
# ==============================================================================
# Usually leave defaults unless customizing Asterisk.

asterisk:
  ami_host: "127.0.0.1"
  ami_port: 5038
  ami_user: "redphone"
  ami_secret: "redphone"
  rtp_start: 10000
  rtp_end: 20000
